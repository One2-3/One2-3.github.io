{{/* 소개/홈 공용: authors/admin에서 프로필 로드 */}}
{{- $ctx := .page -}}
{{- $author := site.GetPage (printf "/%s/authors/admin" $ctx.Lang) -}}

{{- $name := "" -}}
{{- $role := "" -}}
{{- $orgs := slice -}}
{{- $profiles := slice -}}
{{- $avatar := "avatar.png" -}}

{{- if $author -}}
  {{- $name = (or ($author.Param "title") $name) -}}
  {{- $role = (or ($author.Param "role") $role) -}}
  {{- $orgs = (or ($author.Param "organizations") $orgs) -}}
  {{- $profiles = (or ($author.Param "profiles") $profiles) -}}
  {{- $av := ($author.Param "avatar") -}}
  {{- if $av }}{{- $avatar = $av -}}{{- end -}}
{{- end -}}

{{/* 아바타 경로 보정: http/https면 그대로, /로 시작하면 그대로, 나머지는 /media/ 접두 */}}
{{- $avatarURL := $avatar -}}
{{- if not (or (hasPrefix $avatarURL "http://") (hasPrefix $avatarURL "https://") (hasPrefix $avatarURL "/")) -}}
  {{- $avatarURL = (printf "/media/%s" $avatarURL) -}}
{{- end -}}

<section class="py-8">
  <div class="max-w-5xl mx-auto px-6">
    <div class="grid grid-cols-1 md:grid-cols-3 gap-8 items-start">
      <div class="flex justify-center md:justify-start">
        <img src="{{ $avatarURL }}" alt="{{ $name }}" class="rounded-full w-44 h-44 object-cover shadow" />
      </div>
      <div class="md:col-span-2">
        {{ with $name }}<h2 class="text-2xl md:text-3xl font-semibold mb-2">{{ . }}</h2>{{ end }}
        {{ with $role }}<p class="text-gray-600 dark:text-gray-300 mb-3">{{ . }}</p>{{ end }}

        {{ if $orgs }}
          <p class="text-gray-600 dark:text-gray-300 mb-4">
            {{- range $i, $o := $orgs -}}
              {{- if $i }}, {{ end -}}
              {{- with (index $o "url") -}}
                <a href="{{ . }}" target="_blank" rel="noopener">{{ index $o "name" }}</a>
              {{- else -}}
                {{ index $o "name" }}
              {{- end -}}
            {{- end -}}
          </p>
        {{ end }}

        {{ if $profiles }}
          <div class="flex flex-wrap gap-3 mt-2">
            {{- range $p := $profiles -}}
              {{- $url := (or (index $p "url")  "#") -}}
              {{- $label := (or (index $p "label") "") -}}
              <a href="{{ $url }}" class="inline-flex items-center px-3 py-1 rounded-xl border border-gray-300 dark:border-gray-700 hover:bg-gray-100 dark:hover:bg-gray-800">
                <span>{{ $label }}</span>
              </a>
            {{- end -}}
          </div>
        {{ end }}
      </div>
    </div>
  </div>
</section>
